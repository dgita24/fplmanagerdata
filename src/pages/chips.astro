function makeChipsTable(managersData) {
  let html = `<h2>Chips Summary</h2>
  <table border="1" cellpadding="6" style="border-collapse:collapse; margin-bottom: 2em;">
    <tr style="background:#f0f0f0">
      <th>EntryID</th>
      <th>Manager</th>
      <th>Team Name</th>
      <th>Chips Used</th>
      <th>Chips Remaining</th>
    </tr>`;
  
  for (const m of managersData) {
    // Just list the chip names, no GW numbers
    const chipsUsed = m.chips.length > 0 
      ? m.chips.map(c => c.name).join(", ")
      : "None";
    
    const usedChips = m.chips.map(c => c.name);
    const wcCount = usedChips.filter(c => c === "WC").length;
    const bbCount = usedChips.filter(c => c === "BB").length;
    const tcCount = usedChips.filter(c => c === "TC").length;
    const fhCount = usedChips.filter(c => c === "FH").length;
    
    const remaining = [];
    const wcRemaining = 2 - wcCount;
    const bbRemaining = 2 - bbCount;
    const tcRemaining = 2 - tcCount;
    const fhRemaining = 2 - fhCount;
    
    if (wcRemaining > 0) remaining.push(wcRemaining === 2 ? "WC x2" : "WC x1");
    if (bbRemaining > 0) remaining.push(bbRemaining === 2 ? "BB x2" : "BB x1");
    if (tcRemaining > 0) remaining.push(tcRemaining === 2 ? "TC x2" : "TC x1");
    if (fhRemaining > 0) remaining.push(fhRemaining === 2 ? "FH x2" : "FH x1");
    
    const chipsRemaining = remaining.length > 0 ? remaining.join(", ") : "None";
    
    html += `<tr>
      <td>${m.entryId}</td>
      <td>${m.managerName}</td>
      <td>${m.teamName}</td>
      <td>${chipsUsed}</td>
      <td style="background:#fffacd">${chipsRemaining}</td>
    </tr>`;
  }
  html += "</table>";
  
  html += `<h2>Detailed Chip Usage by Gameweek</h2>
  <table border="1" cellpadding="6" style="border-collapse:collapse;">
    <tr style="background:#f0f0f0">
      <th>EntryID</th>
      <th>Manager</th>
      <th>Chip</th>
      <th>Chip Name</th>
      <th>Gameweek</th>
    </tr>`;
  
  for (const m of managersData) {
    if (m.chips.length === 0) {
      html += `<tr>
        <td>${m.entryId}</td>
        <td>${m.managerName}</td>
        <td colspan="3" style="color:#999; font-style:italic;">No chips used yet</td>
      </tr>`;
    } else {
      for (const chip of m.chips) {
        html += `<tr>
          <td>${m.entryId}</td>
          <td>${m.managerName}</td>
          <td style="font-weight:bold; text-align:center;">${chip.name}</td>
          <td>${chip.fullName}</td>
          <td style="text-align:center;">${chip.gw}</td>
        </tr>`;
      }
    }
  }
  html += "</table>";
  
  return html;
}